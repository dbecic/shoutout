(function(){"use strict";var a;angular.module("angularGeoFire",[]).factory("$geofire",["$q","$timeout","$rootScope","$log",function(b,c,d,e){return function(f){e.info("Constructing $geofire");var g=new a(b,c,d,f);return g.construct()}}]),a=function(a,b,c,d){if(this._q=a,this._rootScope=c,this._timeout=b,"string"==typeof d)throw new Error("Please provide a Firebase reference instead of a URL");this._geoRef=d,this._geoFire=new geoFire(this._geoRef),this._onPointsNearLocCallbacks=[],this._onPointsNearId=[]},a.prototype={construct:function(){var a=this,b={};return b.$insertByLoc=function(b,c){var d=a._q.defer();return a._timeout(function(){a._geoFire.insertByLoc(b,c,function(a){a?d.reject(a):d.resolve(null)})}),d.promise},b.$insertByLocWithId=function(b,c,d){var e=a._q.defer();return a._timeout(function(){a._geoFire.insertByLocWithId(b,c,d,function(a){a?e.reject(a):e.resolve(null)})}),e.promise},b.$removeById=function(b){var c=a._q.defer();return a._timeout(function(){a._geoFire.removeById(b,function(a){a?c.reject(a):c.resolve(null)})}),c.promise},b.$getLocById=function(b){var c=a._q.defer();return a._timeout(function(){a._geoFire.getLocById(b,function(a){a?c.resolve(a):c.reject(null)})}),c.promise},b.$updateLocForId=function(b,c){var d=a._q.defer();return a._timeout(function(){a._geoFire.updateLocForId(b,c,function(a){a?d.reject(a):d.resolve(null)})}),d.promise},b.$getPointsNearLoc=function(b,c){var d=a._q.defer();return a._timeout(function(){a._geoFire.getPointsNearLoc(b,c,function(a){d.resolve(a)})}),d.promise},b.$onPointsNearLoc=function(b,c,d){a._onPointsNearLocCallbacks[d]=function(e){a._rootScope.$broadcast(d,b,c,e)},a._timeout(function(){a._geoFire.onPointsNearLoc(b,c,a._onPointsNearLocCallbacks[d])})},b.$offPointsNearLoc=function(b,c,d){a._onPointsNearLocCallbacks[d]&&(a._geoFire.offPointsNearLoc(b,c,a._onPointsNearLocCallbacks[d]),delete a._onPointsNearLocCallbacks[d])},b.$getPointsNearId=function(b,c){var d=a._q.defer();return a._timeout(function(){a._geoFire.getPointsNearId(b,c,function(a){d.resolve(a)})}),d.promise},b.$onPointsNearId=function(b,c,d){a._onPointsNearId[d]=function(e){a._rootScope.$broadcast(d,b,c,e)},a._timeout(function(){a._geoFire.onPointsNearId(b,c,a._onPointsNearId[d])})},b.$offPointsNearId=function(b,c,d){a._onPointsNearId[d]&&(a._geoFire.offPointsNearId(b,c,a._onPointsNearId[d]),delete a._onPointsNearId[d])},b.$encode=function(b,c){return a._geoFire.encode(b,c)},b.$decode=function(b){return a._geoFire.decode(b)},b.$miles2km=function(b){return a._geoFire.miles2km(b)},b.$km2miles=function(b){return a._geoFire.km2miles(b)},a._object=b,a._object}}}).call(this);